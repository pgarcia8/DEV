 var user = "admin";   // Setting the User Namevar reportName = "Demo_URL";  // Setting ReportName of the report that is set in RMvar report = aa.reportManager.getReportInfoModelByName(reportName);report = report.getOutput();report.setModule("Building"); // Setting the module//get cap idvar s_id1 = aa.env.getValue("PermitId1");var s_id2 = aa.env.getValue("PermitId2");var s_id3 = aa.env.getValue("PermitId3");var s_capResult = aa.cap.getCapID(s_id1, s_id2, s_id3).getOutput();report.setCapId(s_capResult.toString());var permit = aa.reportManager.hasPermission(reportName,user);if(permit.getOutput().booleanValue()){  var reportResult = aa.reportManager.getReportResult(report);    if(reportResult.getSuccess())  {    reportResult = reportResult.getOutput();    var reportFile = aa.reportManager.storeReportToDisk(reportResult);    reportFile = reportFile.getOutput();      var sendResult = aa.sendEmail("test_auto@achievo.com", "end_user@achievo.com", "", "SUBJECT from emse", "CONTENT from emse", reportFile);      if(sendResult.getSuccess())    {     aa.env.setValue("ScriptReturnCode", "0");     aa.env.setValue("ScriptReturnMessage", "A copy of this report has been sent to the valid email addresses.");    }    else    {     aa.env.setValue("ScriptReturnCode", "0");     aa.env.setValue("ScriptReturnMessage", "System failed send report to selected email addresses because mail server is broken or report file size is great than 5M.");    }  }  else  {    aa.env.setValue("ScriptReturnCode", "0");    aa.env.setValue("ScriptReturnMessage", "System failed get report.");  }}else{    aa.env.setValue("ScriptReturnCode", "0");    aa.env.setValue("ScriptReturnMessage", "You have no permission.");}