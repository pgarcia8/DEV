 /*********************************************************************** * To get People Template Attribute(dropdown list) values by EMSE Script. * 1. Get peopleNumber(LP/Contact number) from aa.env * 2. Invoke web service URL to get return values. * 3. Populate the return values to aa.env. **********************************************************************/ /** * EMSE script entrance  **/main();/** * Main function  **/function main(){	var rtnCode = "-1";	var licenseProfessionalModel = aa.env.getValue("LICENSE_PROFESSIONAL_MODEL");		if (licenseProfessionalModel == null || licenseProfessionalModel == "")	{		setReturnMessage("License Professional Model is null.");	}	else	{		var licenseNbr = licenseProfessionalModel.getLicenseNbr();		if (licenseNbr == null || licenseNbr == ""){			setReturnMessage("Losing the required parameter[License Number].");		}		else		{			var wsURL = "https://www4.cbs.state.or.us/exs/bcd/accela/ws/accelaws.cfc?method=elect_super&returnformat=json&p_lic_num=" + licenseNbr;			var scriptResult = aa.httpClient.get(wsURL);			if (scriptResult.getSuccess() == true)			{				var result = scriptResult.getOutput();				rtnCode = populateReturnValuesToAAEnv(result.toString());			}			else			{				setReturnMessage(scriptResult.getErrorMessage());			}		}	}		if (rtnCode != "-1")	{		aa.env.setValue("ScriptReturnCode", "0");	}}/** * Populate return values to AAenv. **/function populateReturnValuesToAAEnv(result){	if (result.indexOf("Sorry no signing supervisors in the system") != -1)	{		setReturnMessage("Sorry no signing supervisors in the system!");		return "-1";	}	else	{		var myObj = eval('(' + result + ')');		var list = aa.util.newArrayList();		list.add(myObj.NAME_PAIRS);		aa.env.setValue("PTA_DDLIST_ITEMS",list);				setReturnMessage("Sucessful to get People Template Attribute dropdown list items");		return "0";	}}/** * Set return message **/function setReturnMessage(message){	aa.log(message);	aa.env.setValue("ScriptReturnMessage", message);}