 /*------------------------------------------------------------------------------------------------------/| Program : LicProfAddBefore.js  | Event   : LicProfAddBefore|/------------------------------------------------------------------------------------------------------*/var LicProfModel = aa.env.getValue("LicProfModel");var licenseType = LicProfModel.licenseType;var licenseNbr = LicProfModel.licenseNbr;var licenseValidateReturnCode = "0";var licenseValidateReturnMessage = "Follow Licenses are invalid:";if (!validateLicense(licenseType, licenseNbr)){	licenseValidateReturnCode = "-1";		licenseValidateReturnMessage += "<br>";	licenseValidateReturnMessage += " * License type: " + licenseType;	licenseValidateReturnMessage += " , License number: " + licenseNbr;}// check whether something wrongif (licenseValidateReturnCode != "0"){	aa.env.setValue("ScriptReturnCode", licenseValidateReturnCode);	aa.env.setValue("ScriptReturnMessage", licenseValidateReturnMessage);	}// check whether the licenseType and licenseNbr is valid.function validateLicense(licenseType, licenseNbr){	var accelawsUrl = 'https://www4.cbs.state.or.us/exs/bcd/accela/ws/accelaws.cfc?method=lic_valid&returnformat=json';	var client = aa.httpClient;		// set url parameters	var params = client.initPostParameters();	params.put('p_lic_type', licenseType);	params.put('p_lic_num', licenseNbr);		// do validate via web service	var scripResult = client.post(accelawsUrl, params);			// check the return value	if (scripResult.getSuccess())	{		var resultString = String(scripResult.getOutput());				//Convert to jsonObject		var result = eval("("+resultString+")");		var valid = String(result["VALID"]);		if (valid.toUpperCase() == "TRUE")		{			return true;		}	}	else	{		aa.print("ERROR: Failed to validate license: " + scripResult.getErrorMessage());		return false;	}				return false;}